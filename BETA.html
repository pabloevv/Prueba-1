<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LUGGO - Beta UI</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <link rel="stylesheet" href="app.css" />
</head>
<body>
  <div id="loginOverlay" class="login-overlay">
    <div class="login-card">
      <h1>LUGGO</h1>
      <p class="login-note">Inicia sesi&oacute;n para continuar.</p>
      <button id="loginGoogle" class="btn primary" type="button">Continuar con Google</button>
      <div class="sp-1"></div>
      <form id="loginForm" class="login-form">
        <div>
          <label for="loginEmail">Correo electr&oacute;nico</label>
          <input id="loginEmail" name="email" type="email" placeholder="tu@ejemplo.com" autocomplete="email" required />
        </div>
        <div>
          <label for="loginPassword">Contrase&ntilde;a</label>
          <input id="loginPassword" name="password" type="password" placeholder="Contrase&ntilde;a" autocomplete="current-password" required />
        </div>
        <button type="submit" class="btn ghost">Ingresar con correo</button>
      </form>
      <div id="loginStatus" class="login-status" role="alert"></div>
      <p class="login-note">Si no tienes cuenta la crearemos al iniciar sesi&oacute;n.</p>
    </div>
  </div>
  <div class="app">
    <header>
      <div class="topbar">
        <div class="logo">
          <div class="logo-badge"><span>LG</span></div>
          <div>LUGGO</div>
        </div>
        <div class="search">
          <input id="searchInput" placeholder="Buscar lugares o etiquetas" />
        </div>
      </div>
    </header>

    <main>
      <section class="screen active" data-screen="feed">
        <div id="feedList"></div>
      </section>

      <section class="screen" data-screen="map">
        <div class="map-tools">
          <form id="mapSearchForm" class="map-search">
            <input id="mapSearchInput" type="search" placeholder="Buscar lugar en el mapa" autocomplete="off" />
            <button type="submit" class="btn">Buscar</button>
          </form>
          <div id="mapSearchSuggestions" class="map-suggestions" aria-live="polite"></div>
          <div id="mapSearchStatus" class="map-status" aria-live="polite"></div>
        </div>
        <div id="map" class="map-box"></div>
        <div class="sp-2"></div>
        <div class="muted">Busca un lugar, arrastra el mapa y toca un marcador para ver detalles.</div>
      </section>

      <section class="screen" data-screen="add">
        <div class="card" style="padding: 1rem">
          <div class="title">Crear reseña</div>
          <div class="sp-2"></div>
          <button class="btn primary" onclick="openCreateModal()">Nueva reseña</button>
          <div class="sp-2"></div>
          <div class="muted">Selecciona un punto en el mapa para registrar el lugar.</div>
        </div>
      </section>

      <section class="screen" data-screen="profile">
        <div class="card" style="padding: 1rem">
          <div class="row">
            <div class="row" style="gap:.6rem">
              <div class="avatar">U</div>
              <div>
                <div class="title" id="profileName">Usuario Demo</div>
                <div class="muted"><span id="profileHandle">@demo</span> - <span id="profileStats"></span></div>
              </div>
            </div>
            <button class="btn ghost" onclick="logout()">Cerrar sesi&oacute;n</button>
          </div>
        </div>
        <div class="sp-2"></div>
        <div id="profileList"></div>
      </section>
    </main>

    <div class="fab"><button onclick="openCreateModal()">Añadir</button></div>

    <nav class="tabbar">
      <div class="tabs">
        <button class="active" data-tab="feed">Inicio</button>
        <button data-tab="map">Mapa</button>
        <button data-tab="add">Agregar</button>
        <button data-tab="profile">Perfil</button>
      </div>
    </nav>
  </div>

  <div id="modal" class="modal-backdrop">
    <div class="modal">
      <h3>Registrar reseña</h3>
      <div class="grid" style="margin-bottom:0.8rem">
        <div style="grid-column:1/-1">
          <form id="addPlaceSearchForm" class="map-search">
            <input id="addPlaceSearchInput" type="search" placeholder="Buscar lugar para reseñar" autocomplete="off" />
            <button type="submit" class="btn">Buscar</button>
          </form>
          <div id="addPlaceSuggestions" class="map-suggestions" aria-live="polite"></div>
          <div id="addPlaceStatus" class="map-status" aria-live="polite"></div>
        </div>
        <div class="modal-map" style="grid-column:1/-1">
          <div id="addPlaceMap" class="map-box"></div>
          <div class="map-hint">Haz clic en el mapa o en un resultado para seleccionar el lugar.</div>
        </div>
        <div>
          <label>Nombre del lugar</label>
          <input id="f_placeName" readonly placeholder="Ej. Parque Central" />
        </div>
        <div>
          <label>Dirección / Ciudad</label>
          <input id="f_placeAddress" readonly placeholder="Ciudad o dirección" />
        </div>
        <div>
          <label>Calificación</label>
          <select id="f_rating">
            <option value="5">5 estrellas</option>
            <option value="4">4 estrellas</option>
            <option value="3">3 estrellas</option>
            <option value="2">2 estrellas</option>
            <option value="1">1 estrella</option>
          </select>
        </div>
        <div>
          <label>Foto (URL opcional)</label>
          <input id="f_photo" placeholder="https://" />
        </div>
        <div>
          <label>Subir imagen (archivo local)</label>
          <input id="f_photo_file" type="file" accept="image/*" />
        </div>
        <div class="photo-preview" id="photoPreview" style="grid-column:1/-1"></div>
        <div style="grid-column:1/-1">
          <label>Tu reseña</label>
          <textarea id="f_note" placeholder="¿Qué te gustó? ¿Consejos para otros?"></textarea>
        </div>
        <div style="grid-column:1/-1">
          <label>Etiquetas (coma separadas)</label>
          <input id="f_tags" placeholder="café, brunch, wifi" />
        </div>
      </div>
      <div class="row">
        <button class="btn ghost" onclick="closeCreateModal()">Cancelar</button>
        <button class="btn primary" onclick="saveReview()">Guardar</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    (function () {
      if (window.__API_BASE_URL__) return;
      const tailscaleApi = 'http://100.117.52.45:3000/api';
      const defaultApi = `${window.location.origin}/api`;
      const hostname = window.location.hostname;
      const port = window.location.port || '';
      const isLocalhost = hostname === 'localhost' || hostname === '127.0.0.1';
      const isLiveServer = port === '5500';
      window.__API_BASE_URL__ = isLocalhost && isLiveServer ? tailscaleApi : defaultApi;
    })();
  </script>
  <script src="firebase-config.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-storage-compat.js"></script>
  <script src="app.js"></script>
</body>
</html>






